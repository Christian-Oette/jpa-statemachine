A quick implementation of an idea about a statemachine.

Instead of writing state handling code in your business logic,
move it to the statemachine and handle errors and events with callbacks.
